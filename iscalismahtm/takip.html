<html>
<head>
	<script src="Chart.bundle.min.js"></script>
	<script src="utils.js"></script>
		<script src="script.js"></script>
	<style>
	canvas{
		-moz-user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}
	</style>
<script>
baglanti();
var say=0;
var ucret=0,ucret_real=0;
		var MONTHS = new String('1.1.2019');
		var config = {
			type: 'line',
			data: {
				labels: ['0.0.0'],
				datasets: [{
					label: 'Hesap Hareketleri Grafigi',
					backgroundColor: window.chartColors.gray,
					borderColor: window.chartColors.green,
					data: [
						0
					],
					fill: false,
				}]
			},
			options: {
				responsive: true,
				title: {
					display: true,
					text: 'Cari Hareket'
				},
				tooltips: {
					mode: 'index',
					intersect: false,
				},
				hover: {
					mode: 'nearest',
					intersect: true
				},
				scales: {
					xAxes: [{
						display: true,
						scaleLabel: {
							display: true,
							labelString: 'Tarih'
						}
					}],
					yAxes: [{
						display: true,
						scaleLabel: {
							display: true,
							labelString: 'Guncel Bakiye'
						}
					}]
				}
			}
		};


		
window.addEventListener("load",function(){

baslangic();
// Code to connect the MS Access database using java Script
// " C:/my_db.mdb " is the MS Access database
var count=0;
var a=0;
var b=0;
var str=new Array();
cn= new ActiveXObject("ADODB.Connection");
cn.Open("Provider=Microsoft.Jet.OLEDB.4.0;Data Source = iscalismahtm/is.mdb");
rs = new ActiveXObject("ADODB.Recordset");
var SQL = "select distinct(ad) from isi"; 
rs.Open(SQL, cn);
document.getElementById("is").innerHTML="<option>bos</option>";
document.getElementById("firma").innerHTML="<option>bos</option>";
 while (!rs.eof){
//document.getElementById("firma").innerHTML+='<option>'+rs.fields(0).value+'</option>';
		str[count++]=rs.fields(0).value;
        rs.MoveNext();
    }
	rs.Close();
	var h;
	for(h=0;h<count;h++)
	{
		a=0;b=0;
		rs = new ActiveXObject("ADODB.Recordset");
		var SQL = "SELECT sum(ucret) FROM isi WHERE isi.ad='"+str[h]+"'"; 
		rs.Open(SQL, cn);
		if(!rs.eof){
//document.getElementById("firma").innerHTML+='<option>'+rs.fields(0).value+'</option>';
		a=rs.fields(0).value;
		}
	rs.Close();
		rs = new ActiveXObject("ADODB.Recordset");
		var SQL="SELECT sum(tahsil.kBakiye)  FROM tahsil,isi WHERE isi.iNo=tahsil.iNo and isi.ad='"+str[h]+"'"; 
		rs.Open(SQL, cn);
		if(!rs.eof){
//document.getElementById("firma").innerHTML+='<option>'+rs.fields(0).value+'</option>';
		b=rs.fields(0).value;
		}
		rs.Close();
		if(a>b)document.getElementById("firma").innerHTML+='<option>'+str[h]+'</option>';
	}
	
	rs = new ActiveXObject("ADODB.Recordset");
SQL = "select iNo from isi"; 
rs.Open(SQL, cn);document.getElementById("is").innerHTML="";
 while (!rs.eof){

document.getElementById("is").innerHTML+='<option value='+rs.fields(0).value+'>'+rs.fields(0).value+'</option>';
        rs.MoveNext();
    }

rs.Close(); 	
},false);

</script>
</head>
<body>
<h4>Tahsil Etme Sayfasi</h4>
Firma<select id="firma" name="firma" onchange="isFiltrele()"><br>
<option value="1">bir</option>
<option value="2">iki</option>
</select><br>
Is Numarasi
<select id="is" name="is" onchange="filter_id(this.value)">
<option value="3">uc</option>
<option value="4">dort</option>
</select><br>
<input type="text" name="ucret" id="ucret" placeholder="ucret giriniz"> <br>
<input type="text" name="tarih" id="tarih" placeholder="tarih giriniz"><br>
<input type="button" value="tahsil" onclick="tahsilEt()"><br>
<h4>Yapilan Isler ve Tahsilatlar</h4>
<table id="table">
</table>
<h4>Cari Borc/Alacak Grafigi</h4>
<div style="width:57%;">
<canvas id="canvas">
</canvas>
</div>
</body>
</html>